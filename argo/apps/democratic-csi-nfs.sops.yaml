apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: democratic-csi-nfs
    namespace: argocd
spec:
    project: default
    source:
        repoURL: https://democratic-csi.github.io/charts/
        chart: democratic-csi
        targetRevision: 0.14.7
        helm:
            valuesObject:
                csiDriver:
                    name: org.democratic-csi.nfs
                storageClasses:
                    - name: truenas-nfs
                      defaultClass: false
                      reclaimPolicy: Delete
                      volumeBindingMode: Immediate
                      allowVolumeExpansion: true
                      parameters:
                        fsType: nfs
                      mountOptions:
                        - nfsvers=4
                        - nolock
                        - soft
                volumeSnapshotClasses:
                    - name: truenas-nfs
                driver:
                    config:
                        driver: freenas-api-nfs
                        httpConnection:
                            protocol: https
                            host: 192.168.2.30
                            port: 443
                            apiKey: ENC[AES256_GCM,data:PVUNrsR37/3WGgBYBhv3kyRxJVz7e31dGLnyXE9Bymplvn3Pnso9PqeK+ufAbx50bys+ijtFkityw4WmwjgLzpM6,iv:eKKzL9sGmZMg+bY24py6lQf8fZRteKTmh/CbU7LHy90=,tag:XMIRF3z5WrFuYRvv93gecw==,type:str]
                            allowInsecure: true
                        zfs:
                            datasetParentName: default/smb-share
                            detachedSnapshotsDatasetParentName: default/smb-share-snapshots
                            datasetEnableQuotas: true
                            datasetEnableReservation: false
                            datasetPermissionsMode: "0770"
                            datasetPermissionsUser: 0
                            datasetPermissionsGroup: 0
                        nfs:
                            shareHost: 192.168.2.30
                            shareAlldirs: false
                            shareAllowedHosts: []
                            shareAllowedNetworks: []
                            shareMaprootUser: root
                            shareMaprootGroup: root
    destination:
        server: https://kubernetes.default.svc
        namespace: democratic-csi
    syncPolicy:
        automated:
            prune: true
            selfHeal: true
        syncOptions:
            - CreateNamespace=true
sops:
    age:
        - recipient: age1033ld5gtn23xsz9lateded3kpssp62hkhjq9vs3jza3ad63uggnsqw5xhd
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBGQTZmYlVjVG1MRGlOajRU
            T2t5NlVHTzgwb2FCNGhtaFREMGdtNlFEVDFjCmF3K0JYUjRZS0pHNXQxdmlGQ1pI
            QS9GV2xJdUNvZWMzTXMvZEhmZzE4bzQKLS0tIExtS3p0dkh1S3RvbktvTjU1U3Ix
            RFJWb1NiS0VhMjZTMk10WlNYRGdLeG8KBBsyIT+MAHNC4O9DVZBXNV282Zd3YRiF
            4/D47xXcnp1gNXXKx+86SP+RyjXgFc+xs4glnZ4PrZeJZhQleI/xUg==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-12-05T21:12:46Z"
    mac: ENC[AES256_GCM,data:tEq9WK2PZfRi1EC3bYUgcGiK64lnZ6P0O0hLrSWjqir575HDIejGSRmNJkLHh5IRrOCTH7s1GLZHg7rDXkiyGiIagpY9DWOFpjk7q9thgyZTksozSQ3a0PoArGoyO2KAANXXz3p55J/HFulpJ7ie5BbsnC3yALzJVlFRWp6Y5W8=,iv:BT52yZQbExBlDqt8ASb/30Vin7Igi8T4AbF3Uu9xNVQ=,tag:HQvRbSzTYGoO3KbTZhrrag==,type:str]
    encrypted_regex: ^(data|stringData|apiKey)$
    version: 3.11.0
